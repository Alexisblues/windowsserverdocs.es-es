---
title: ktpass
description: Tema de referencia de * * * *-
ms.prod: windows-server
ms.technology: manage-windows-commands
ms.topic: article
ms.assetid: 47087676-311e-41f1-8414-199740d01444
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: 09f0a715c8addf8694eb75d17f9b8089cad72e56
ms.sourcegitcommit: ab64dc83fca28039416c26226815502d0193500c
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/01/2020
ms.locfileid: "82724531"
---
# <a name="ktpass"></a>ktpass

> Se aplica a: Windows Server (canal semianual), Windows Server 2019, Windows Server 2016, Windows Server 2012 R2 y Windows Server 2012

Configura el nombre de la entidad de seguridad del servidor para el host o servicio en servicios de dominio de Active Directory (AD DS) y genera un archivo. El archivo .keytab se basa en la implementación del Instituto Tecnológico de Massachusetts (MIT) del protocolo de autenticación Kerberos. La herramienta de línea de comandos ktpass permite que los servicios que no son de Windows que admiten la autenticación Kerberos utilicen las características de interoperabilidad proporcionadas por el servicio Centro de distribución de claves de Kerberos (KDC). Este tema se aplica a las versiones de sistema operativo designadas en la lista **se aplica a que se** encuentra al principio del tema.  

## <a name="syntax"></a>Sintaxis  
```  
ktpass  
[/out <FileName>]   
[/princ <PrincipalName>]   
[/mapuser <UserAccount>]   
[/mapop {add|set}] [{-|+}desonly] [/in <FileName>]  
[/pass {Password|*|{-|+}rndpass}]  
[/minpass]  
[/maxpass]  
[/crypto {DES-CBC-CRC|DES-CBC-MD5|RC4-HMAC-NT|AES256-SHA1|AES128-SHA1|All}]  
[/itercount]  
[/ptype {KRB5_NT_PRINCIPAL|KRB5_NT_SRV_INST|KRB5_NT_SRV_HST}]  
[/kvno <KeyversionNum>]  
[/answer {-|+}]  
[/target]  
[/rawsalt] [{-|+}dumpsalt] [{-|+}setupn] [{-|+}setpass <Password>]  [/?|/h|/help]  
```  
### <a name="parameters"></a>Parámetros  

|                                             Parámetro                                              |                                                                                                                                                                                                                                                                                                      Descripción                                                                                                                                                                                                                                                                                                       |
|----------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                          /out<FileName>                                           |                                                                                                                                                                        Especifica el nombre del archivo de claves de claves de Kerberos versión 5 que se va a generar. **Nota:** Este es el archivo. de claves de usuario que se transfiere a un equipo que no está ejecutando el sistema operativo Windows y, a continuación, se reemplaza o se combina con el archivo./Etc/Krb5.keytab. existente.                                                                                                                                                                        |
|                                       /princ<PrincipalName>                                       |                                                                                                                                                                                                                   Especifica el nombre de la entidad de host/computer.contoso.com@CONTOSO.COMseguridad en el formulario. **ADVERTENCIA:** Este parámetro distingue entre mayúsculas y minúsculas. Vea la [sección Comentarios](#BKMK_remarks) para obtener más información.                                                                                                                                                                                                                    |
|                                       /mapuser<UserAccount>                                       |                                                                                                                                                                                                                                                Asigna el nombre de la entidad de seguridad de Kerberos, que se especifica mediante el parámetro **princ** , a la cuenta de dominio especificada.                                                                                                                                                                                                                                                |
|                                       /mapop {agregar&#124;set}                                        |                                                                                                                                                                             Especifica cómo se establece el atributo de asignación.<p>-   **Agregar** agrega el valor del nombre de usuario local especificado. Este es el valor predeterminado.<br />-   **Set** establece el valor para el cifrado solo del estándar de cifrado de datos (des) para el nombre de usuario local especificado.                                                                                                                                                                             |
|                                         {-&#124;+} solo                                          |                                                                                                                                                            De forma predeterminada, se establece el cifrado de solo DES.<p>-   **+** Establece una cuenta para el cifrado de solo DES.<br />-   **-** Libera la restricción en una cuenta para el cifrado solo DES. **Importante:** A partir de Windows 7 y Windows Server 2008 R2, Windows no admite DES de forma predeterminada.                                                                                                                                                            |
|                                           /in<FileName>                                           |                                                                                                                                                                                                                                                       Especifica el archivo. de la operación de escritura que se va a leer de un equipo host que no está ejecutando el sistema operativo Windows.                                                                                                                                                                                                                                                        |
|                          /Pass {password&#124;\*&#124; {-&#124;+} rndpass}                           |                                                                                                                                                                                                                                           Especifica una contraseña para el nombre de usuario de la entidad de seguridad que se especifica mediante el parámetro **princ** . Use \* para solicitar una contraseña.                                                                                                                                                                                                                                            |
|                                              /minpass                                              |                                                                                                                                                                                                                                                                            Establece la longitud mínima de la contraseña aleatoria en 15 caracteres.                                                                                                                                                                                                                                                                            |
|                                              /maxpass                                              |                                                                                                                                                                                                                                                                           Establece la longitud máxima de la contraseña aleatoria en 256 caracteres.                                                                                                                                                                                                                                                                            |
| /Crypto {DES-CBC-CRC&#124;DES-CBC-MD5&#124;RC4-HMAC-NT&#124;AES256-SHA1&#124;AES128-SHA1&#124;All} | Especifica las claves que se generan en el archivo de la clave de claves:<p>-   **Des-CBC-CRC** se usa por compatibilidad.<br />-   **Des-CBC-MD5** se adhiere más a la implementación de MIT y se usa por compatibilidad.<br />-   **RC4-HMAC-NT** emplea el cifrado de 128 bits.<br />-   **AES256-SHA1** emplea el cifrado AES256-CTS-HMAC-SHA1-96.<br />-   **AES128-SHA1** emplea el cifrado AES128-CTS-HMAC-SHA1-96.<br />-   **Todos** los Estados en los que se pueden usar todos los tipos de cifrado admitidos. **Nota:** La configuración predeterminada se basa en las versiones anteriores de MIT. Por lo `/crypto` tanto, siempre debe especificarse. |
|                                             /itercount                                             |                                                                                                                                                                                                                        Especifica el recuento de iteraciones que se usa para el cifrado AES. El valor predeterminado es que **itercount** se omite para el cifrado que no sea AES y se establece en 4.096 para el cifrado AES.                                                                                                                                                                                                                         |
|               /Ptype {KRB5_NT_PRINCIPAL&#124;KRB5_NT_SRV_INST&#124;KRB5_NT_SRV_HST}                |                                                                                                                                                                                         Especifica el tipo de entidad de seguridad.<p>-   **KRB5_NT_PRINCIPAL** es el tipo de entidad de seguridad general (recomendado).<br />-   **KRB5_NT_SRV_INST** es la instancia de servicio de usuario.<br />-   **KRB5_NT_SRV_HST** es la instancia de servicio de host.                                                                                                                                                                                         |
|                                       /kvno<KeyversionNum>                                        |                                                                                                                                                                                                                                                                               Especifica el número de versión de la clave. El valor predeterminado es 1.                                                                                                                                                                                                                                                                                |
|                                         /Answer {-&#124;+}                                         |                                                                                                                                                                                                                    Establece el modo de respuesta en segundo plano:<p>**-** Las respuestas restablecer contraseñas se solicitan automáticamente sin.<p>**+** Respuestas restablecer contraseñas se solicita automáticamente con sí.                                                                                                                                                                                                                     |
|                                              /target                                               |                                                                                                                                                                                           Establece el controlador de dominio que se va a usar. El valor predeterminado es para que se detecte el controlador de dominio, en función del nombre de la entidad de seguridad. Si el nombre del controlador de dominio no se resuelve, un cuadro de diálogo solicitará un controlador de dominio válido.                                                                                                                                                                                           |
|                                              /rawsalt                                              |                                                                                                                                                                                                                                                           obliga a ktpass a usar el algoritmo rawsalt al generar la clave. Este parámetro no es necesario.                                                                                                                                                                                                                                                            |
|                                         {-&#124;+} dumpsalt                                         |                                                                                                                                                                                                                                                           La salida de este parámetro muestra el algoritmo de sal de MIT que se usa para generar la clave.                                                                                                                                                                                                                                                            |
|                                          {-&#124;+} programa de instalación                                          |                                                                                                                                                                                                                                          Establece el nombre principal de usuario (UPN) además del nombre de entidad de seguridad de servicio (SPN). El valor predeterminado es establecer ambos en el archivo.                                                                                                                                                                                                                                           |
|                                    {-&#124;+} setpass<Password>                                    |                                                                                                                                                                                                                                                          Establece la contraseña del usuario cuando se proporciona. Si se usa rndpass, en su lugar se genera una contraseña aleatoria.                                                                                                                                                                                                                                                           |
|                                       /? &#124;/h&#124;/Help                                        |                                                                                                                                                                                                                                                                                         Muestra la ayuda de la línea de comandos para ktpass.                                                                                                                                                                                                                                                                                         |

## <a name="remarks"></a><a name=BKMK_remarks></a>sección  
Los servicios que se ejecutan en sistemas que no ejecutan el sistema operativo Windows se pueden configurar con cuentas de instancia de servicio en servicios de dominio de Active Directory. Esto permite a cualquier cliente Kerberos autenticarse en servicios que no ejecutan el sistema operativo Windows mediante el uso de los KDC de Windows.  
Ktpass no evalúa el parámetro/princ y se usa tal y como se proporciona. No hay ninguna comprobación para ver si el parámetro coincide con las mayúsculas y minúsculas exactas del valor del atributo **userPrincipalName** al generar el archivo de la marca de claves. Las distribuciones de Kerberos que distinguen mayúsculas de minúsculas con este archivo de la misma pueden tener problemas cuando no hay ninguna coincidencia exacta de mayúsculas y minúsculas durante la autenticación previa. Compruebe y recupere el valor de atributo **userPrincipalName** correcto de un archivo de exportación LDifDE. Por ejemplo:  
```  
ldifde /f keytab_user.ldf /d CN=Keytab User,OU=UserAccounts,DC=contoso,DC=corp,DC=microsoft,DC=com /p base /l samaccountname,userprincipalname  
```  
## <a name="examples"></a>Ejemplos  
Ilustra cómo crear un archivo. de claves de claves de Kerberos, Machine. separable, en el directorio actual para el usuario Sample1. (Combinará este archivo con el archivo Krb5. adcreation en un equipo host que no ejecute el sistema operativo Windows). Se creará el archivo Kerberos. de la entidad de claves para todos los tipos de cifrado admitidos para el tipo de entidad de seguridad general.  
Para generar un archivo. de asignación de claves para un equipo host que no ejecute el sistema operativo Windows, siga estos pasos para asignar la entidad de seguridad a la cuenta y establecer la contraseña de la entidad de seguridad del host:  
1.  Use el complemento usuarios y equipos de Active Directory para crear una cuenta de usuario para un servicio en un equipo que no esté ejecutando el sistema operativo Windows. Por ejemplo, cree una cuenta con el nombre Sample1.  
2.  Use ktpass para configurar una asignación de identidad para la cuenta de usuario. para ello, escriba lo siguiente en un símbolo del sistema:  
    ```  
    ktpass /princ host/Sample1.contoso.com@CONTOSO.COM /mapuser Sample1 /pass MyPas$w0rd /out Sample1.keytab /crypto all /ptype KRB5_NT_PRINCIPAL /mapop set   
    ```  

    > [!NOTE]  
    > No se pueden asignar varias instancias de servicio a la misma cuenta de usuario.  

3.  Combine el archivo. de claves de claves con el archivo/Etc/Krb5.keytab en un equipo host que no esté ejecutando el sistema operativo Windows. 

## <a name="additional-references"></a>Referencias adicionales  
- [Clave de sintaxis de línea de comandos](command-line-syntax-key.md)  
