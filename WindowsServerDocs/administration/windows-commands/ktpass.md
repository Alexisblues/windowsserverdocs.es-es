---
title: ktpass
description: 'Tema de los comandos de Windows para ***- '
ms.custom: na
ms.prod: windows-server-threshold
ms.reviewer: na
ms.suite: na
ms.technology: manage-windows-commands
ms.tgt_pltfrm: na
ms.topic: article
ms.assetid: 47087676-311e-41f1-8414-199740d01444
author: coreyp-at-msft
ms.author: coreyp
manager: dongill
ms.date: 10/16/2017
ms.openlocfilehash: ae7508aaefd136a91bd19e547b407020293ca484
ms.sourcegitcommit: eaf071249b6eb6b1a758b38579a2d87710abfb54
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 05/31/2019
ms.locfileid: "66437927"
---
# <a name="ktpass"></a>ktpass

>Se aplica a: Windows Server (canal semianual), Windows Server 2016, Windows Server 2012 R2, Windows Server 2012

Configura el nombre del servidor principal para el host o servicio en active directory Domain Services (AD DS) y genera un archivo .keytab que contiene la clave secreta compartida del servicio. El archivo .keytab se basa en la implementación del Instituto Tecnológico de Massachusetts (MIT) del protocolo de autenticación Kerberos. La herramienta de línea de comandos ktpass permite a los servicios que no son Windows que admiten la autenticación Kerberos para usar las características de interoperabilidad proporcionadas por el servicio del centro de distribución de claves Kerberos (KDC). En este tema se aplica a las versiones de sistema operativo designadas en la **se aplica a** lista al principio del tema.  

## <a name="syntax"></a>Sintaxis  
```  
ktpass  
[/out <FileName>]   
[/princ <PrincipalName>]   
[/mapuser <UserAccount>]   
[/mapop {add|set}] [{-|+}desonly] [/in <FileName>]  
[/pass {Password|*|{-|+}rndpass}]  
[/minpass]  
[/maxpass]  
[/crypto {DES-CBC-CRC|DES-CBC-MD5|RC4-HMAC-NT|AES256-SHA1|AES128-SHA1|All}]  
[/itercount]  
[/ptype {KRB5_NT_PRINCIPAL|KRB5_NT_SRV_INST|KRB5_NT_SRV_HST}]  
[/kvno <KeyversionNum>]  
[/answer {-|+}]  
[/target]  
[/rawsalt] [{-|+}dumpsalt] [{-|+}setupn] [{-|+}setpass <Password>]  [/?|/h|/help]  
```  
## <a name="parameters"></a>Parámetros  

|                                             Parámetro                                              |                                                                                                                                                                                                                                                                                                      Descripción                                                                                                                                                                                                                                                                                                       |
|----------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
|                                          /out <FileName>                                           |                                                                                                                                                                        Especifica el nombre del archivo Kerberos versión 5 .keytab para generar. **Nota:** Este es el archivo .keytab que transferir a un equipo que no se está ejecutando el sistema operativo Windows, y, a continuación, reemplazar o combinar con el archivo .keytab existente, /Etc/Krb5.keytab.                                                                                                                                                                        |
|                                       /princ <PrincipalName>                                       |                                                                                                                                                                                                                   Especifica el nombre de entidad de seguridad en el formulario host/computer.contoso.com@CONTOSO.COM. **Advertencia:** Este parámetro distingue mayúsculas de minúsculas. Consulte [comentarios](#BKMK_remarks) para obtener más información.                                                                                                                                                                                                                    |
|                                       /mapuser <UserAccount>                                       |                                                                                                                                                                                                                                                Asigna el nombre de la entidad de seguridad de Kerberos, que se especifica mediante el **princ** parámetro a la cuenta de dominio especificado.                                                                                                                                                                                                                                                |
|                                       /mapop {agregar&#124;establecer}                                        |                                                                                                                                                                             Especifica cómo se establece el atributo de asignación.<br /><br />-   **agregar** agrega el valor del nombre de usuario local especificado. Este es el valor predeterminado.<br />-   **Establecer** establece el valor de cifrado de datos estándar (DES)-cifrado solo para el nombre de usuario local especificado.                                                                                                                                                                             |
|                                         {-&#124;+} desonly                                          |                                                                                                                                                            El cifrado DES solo se establece de forma predeterminada.<br /><br />-    **+** Establece una cuenta para el cifrado solo DES.<br />-    **-** Restricción de versiones en una cuenta para el cifrado solo DES. **IMPORTANTE:** A partir de Windows 7 y Windows Server 2008 R2, Windows no admiten DES de forma predeterminada.                                                                                                                                                            |
|                                           /in <FileName>                                           |                                                                                                                                                                                                                                                       Especifica el archivo .keytab para leer desde un equipo host que no se está ejecutando el sistema operativo Windows.                                                                                                                                                                                                                                                        |
|                          / pasar {contraseña&#124;\*&#124;{-&#124;+} rndpass}                           |                                                                                                                                                                                                                                           Especifica una contraseña para el nombre de usuario de entidad especificado por el **princ** parámetro. Use "\*" para solicitar una contraseña.                                                                                                                                                                                                                                            |
|                                              /minpass                                              |                                                                                                                                                                                                                                                                            Establece la longitud mínima de la contraseña aleatoria y 15 caracteres.                                                                                                                                                                                                                                                                            |
|                                              /maxpass                                              |                                                                                                                                                                                                                                                                           Establece la longitud máxima de la contraseña aleatoria a 256 caracteres.                                                                                                                                                                                                                                                                            |
| / crypto {DES-CBC-CRC&#124;DES-CBC-MD5&#124;RC4-HMAC-NT&#124;AES256-SHA1&#124;SHA1-AES128&#124;todas} | Especifica las claves que se generan en el archivo keytab:<br /><br />-   **DES-CBC-CRC** se usa para la compatibilidad.<br />-   **DES-CBC-MD5** se ajusta mejor a la implementación de MIT y se usa para la compatibilidad.<br />-   **RC4-HMAC-NT** utiliza cifrado de 128 bits.<br />-   **AES256-SHA1** utiliza cifrado AES256-CTS-HMAC-SHA1-96.<br />-   **SHA1-aes128** utiliza cifrado AES128-CTS-HMAC-SHA1-96.<br />-   **Todos los** se pueden usar estados que todos los tipos cifrados admitidos. **Nota:** La configuración predeterminada se basa en versiones anteriores de MIT. Por lo tanto, `/crypto` siempre debe especificarse. |
|                                             /itercount                                             |                                                                                                                                                                                                                        Especifica el número de iteraciones que se usa para el cifrado de AES. El valor predeterminado es que **itercount** se omite para el cifrado no AES y establecer en 4.096 para el cifrado de AES.                                                                                                                                                                                                                         |
|               /ptype {KRB5_NT_PRINCIPAL&#124;KRB5_NT_SRV_INST&#124;KRB5_NT_SRV_HST}                |                                                                                                                                                                                         Especifica el tipo de entidad de seguridad.<br /><br />-   **KRB5_NT_PRINCIPAL** es el tipo entidad general (recomendado).<br />-   **KRB5_NT_SRV_INST** es la instancia de servicio de usuario.<br />-   **KRB5_NT_SRV_HST** es la instancia de servicio de host.                                                                                                                                                                                         |
|                                       /kvno <KeyversionNum>                                        |                                                                                                                                                                                                                                                                               Especifica el número de versión de la clave. El valor predeterminado es 1.                                                                                                                                                                                                                                                                                |
|                                         / respuestas {-&#124;+}                                         |                                                                                                                                                                                                                    Establece el modo de respuesta en segundo plano:<br /><br />**-** Respuestas de restablecimiento de contraseña de nuevo automáticamente con el número.<br /><br />**+** Respuestas de restablecimiento de contraseña de nuevo automáticamente con Sí.                                                                                                                                                                                                                     |
|                                              /target                                               |                                                                                                                                                                                           Establece el controlador de dominio para usar. El valor predeterminado es para que el controlador de dominio que se ha detectado, según el nombre de entidad de seguridad. Si no logra resolver el nombre del controlador de dominio, un cuadro de diálogo le pedirá un controlador de dominio válido.                                                                                                                                                                                           |
|                                              /rawsalt                                              |                                                                                                                                                                                                                                                           fuerza ktpass pueden utilizar el algoritmo rawsalt al generar la clave. Este parámetro no es necesario.                                                                                                                                                                                                                                                            |
|                                         {-&#124;+} dumpsalt                                         |                                                                                                                                                                                                                                                           El resultado de este parámetro muestra el algoritmo MIT "salt" que se utiliza para generar la clave.                                                                                                                                                                                                                                                            |
|                                          {-&#124;+} setupn                                          |                                                                                                                                                                                                                                          Establece el nombre principal de usuario (UPN) además del nombre principal de servicio (SPN). El valor predeterminado es establecer tanto en el archivo .keytab.                                                                                                                                                                                                                                           |
|                                    {-&#124;+} setpass <Password>                                    |                                                                                                                                                                                                                                                          Establece la contraseña del usuario cuando proporcionado. Si se usa rndpass, se generará una contraseña aleatoria.                                                                                                                                                                                                                                                           |
|                                       /?&#124;/h&#124;/help                                        |                                                                                                                                                                                                                                                                                         Línea de comandos de muestra ayuda para ktpass.                                                                                                                                                                                                                                                                                         |

## <a name="BKMK_remarks"></a>remarks  
Servicios que se ejecutan en sistemas que no ejecutan el sistema operativo de Windows pueden configurarse con las cuentas de la instancia de servicio en servicios de dominio de active directory. Esto permite que cualquier cliente de Kerberos autenticar a los servicios que no se está ejecutando el sistema operativo de Windows mediante el uso de los KDC de Windows.  
El parámetro /princ ktpass no evalúa y se usa como la proporcionada. No hay ninguna comprobación para ver si el parámetro coincide con las mayúsculas de la **userPrincipalName** valor del atributo al generar el archivo Keytab. Distribuciones de Kerberos distinguen mayúsculas de minúsculas con este archivo Keytab podrían tener problemas cuando no hay ninguna coincidencia exacta de casos y podría producirse un error durante la autenticación previa. Compruebe y recupere el valor correcto **userPrincipalName** valor del atributo de un archivo de exportación de LDifDE. Por ejemplo:  
```  
ldifde /f keytab_user.ldf /d "CN=Keytab User,OU=UserAccounts,DC=contoso,DC=corp,DC=microsoft,DC=com" /p base /l samaccountname,userprincipalname  
```  
## <a name="BKMK_examples"></a>Ejemplos  
El ejemplo siguiente muestra cómo crear un archivo .keytab Kerberos, machine.keytab, en el directorio actual para el usuario Sample1. (Se combinarán este archivo con el archivo Krb5.keytab en un equipo host que no se está ejecutando el sistema operativo de Windows). Se creará el archivo .keytab de Kerberos para todos los tipos de cifrado admitidos para el tipo de entidad de seguridad general.  
Para generar un archivo .keytab para un equipo host que no se está ejecutando el sistema operativo de Windows, use los pasos siguientes para asignar la entidad de seguridad a la cuenta y establecer la contraseña de entidad de seguridad de host:  
1.  Use el usuario de active directory y equipos de complemento para crear una cuenta de usuario para un servicio en un equipo que no se está ejecutando el sistema operativo Windows. Por ejemplo, cree una cuenta con el nombre Sample1.  
2.  Utilice ktpass para configurar una asignación de identidad para la cuenta de usuario, escriba lo siguiente en un símbolo del sistema:  
    ```  
    ktpass /princ host/Sample1.contoso.com@CONTOSO.COM /mapuser Sample1 /pass MyPas$w0rd /out Sample1.keytab /crypto all /ptype KRB5_NT_PRINCIPAL /mapop set   
    ```  

    > [!NOTE]  
    > No se puede asignar varias instancias de servicio en la misma cuenta de usuario.  

3.  Combine el archivo .keytab con el archivo /Etc/Krb5.keytab en un equipo host que no se está ejecutando el sistema operativo Windows. 

#### <a name="additional-references"></a>Referencias adicionales  
[Clave de sintaxis de línea de comandos](command-line-syntax-key.md)  
