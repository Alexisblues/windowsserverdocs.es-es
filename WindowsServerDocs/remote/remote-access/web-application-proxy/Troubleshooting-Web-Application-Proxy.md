---
title: Solución de problemas del Proxy de aplicación web
description: ''
author: kgremban
manager: femila
ms.date: 07/13/2016
ms.topic: article
ms.prod: windows-server-threshold
ms.assetid: a2fef55d-747b-4e20-8f21-5f8807e7ef87
ms.technology: web-app-proxy
ms.openlocfilehash: c63dbc415765cbe60bfbde7bf180f3dd967d6ab8
ms.sourcegitcommit: 0d0b32c8986ba7db9536e0b8648d4ddf9b03e452
ms.translationtype: MT
ms.contentlocale: es-ES
ms.lasthandoff: 04/17/2019
ms.locfileid: "59841586"
---
# <a name="troubleshooting-web-application-proxy"></a>Solución de problemas del Proxy de aplicación web

>Se aplica a: Windows Server 2016

**Este contenido es relevante para la versión local del Proxy de aplicación Web. Para habilitar el acceso seguro a aplicaciones locales a través de la nube, consulte el [contenido de Azure AD Application Proxy](https://azure.microsoft.com/documentation/articles/active-directory-application-proxy-get-started/).**  
  
Esta sección proporciona procedimientos para solucionar problemas de Proxy de aplicación Web incluidas soluciones y explicaciones de eventos. Hay tres lugares donde se muestran los errores:  
  
-   En la consola de administrador Proxy de aplicación Web  
  
    Cada Id. de evento aparecen en la consola de administrador puede verse en el Visor de eventos de Windows y las descripciones correspondientes y soluciones se encuentran a continuación.  
  
    Abra el Visor de eventos y busque eventos relacionados con el Proxy de aplicación Web en **registros de aplicaciones y servicios** > **Microsoft** > **Windows**  >  **Proxy de aplicación web** > **Admin**  
  
    ![](media/Troubleshooting-Web-Application-Proxy/WebApplicationProxyTroubleshooting.png)  
  
    Si es necesario, los registros detallados están disponibles mediante la activación de análisis y los registros de depuración y activar el registro de sesión del Proxy de aplicación Web, se encuentra en el Visor de eventos de Windows en \ Microsoft \ Windows \ Proxy de aplicación Web \ Admin.  
  
-   Errores de PowerShell  
  
    Eventos de los problemas detectados durante la configuración se muestran en PowerShell.  
  
    Todos los errores se presentan al usuario PowerShell mediante mensajes de error estándares de PowerShell. Todos los comandos de PowerShell se registran como eventos. Todos los eventos que se producen en PowerShell se muestran en el Visor de eventos de Windows con el número de identificación 12016 y se definen a continuación, en la sección de PowerShell.  
  
-   En el analizador de procedimientos recomendados  
  
    Estos eventos se describen en la [Best Practices Analyzer para Proxy de aplicación Web](assetId:///995f5cea-e334-4ce6-a14c-6a2d03c0c79a)  
  
## <a name="powershell-messages"></a>Mensajes de PowerShell  
  
|Síntoma o evento|Causa posible|Resolución|  
|--------------------|------------------|--------------|  
|El certificado de confianza ("ProxyTrust de ADFS - <WAP machine name>") no es válido|La causa puede ser una de las siguientes:<br /><br />-El equipo Proxy de aplicación estaba inactivo durante demasiado tiempo.<br />-Desconexiones entre el Proxy de aplicación Web y AD FS<br />: Problemas de infraestructura de certificado<br />-Cambios en la máquina AD FS o el proceso de renovación entre el Proxy de aplicación Web y AD FS no se ejecutan según lo previsto cada 8 horas, a continuación, debe renovar la confianza<br />-El reloj del equipo Proxy de aplicación Web de AD FS y no están sincronizadas.|Asegúrese de que se sincronizan los relojes. Ejecute el cmdlet Install-WebApplicationProxy.|  
|No se encontraron datos de configuración de AD FS|Esto puede deberse a Proxy de aplicación Web no se instaló completamente aún o debido a cambios en la base de datos de AD FS o los daños de la base de datos.|Ejecute el Cmdlet Install-WebApplicationProxy.|  
|Se produjo un error cuando el Proxy de aplicación Web intentó leer la configuración de AD FS.|Esto puede indicar que AD FS no está accesible o que AD FS detectó un problema interno al intentar leer la configuración de la base de datos de AD FS.|Compruebe que AD FS está accesible y funcionan correctamente.|  
|Los datos de configuración almacenados en AD FS está dañados o Proxy de aplicación Web no pudo analizarlo.<br /><br />O bien,<br /><br />Proxywas de aplicación Web no se puede recuperar la lista de usuarios de confianza de AD FS.|Esto puede ocurrir si se ha modificado los datos de configuración de AD FS.|Reinicie el Proxyservice de aplicación Web. Si el problema persiste, ejecute el Cmdlet Install-WebApplicationProxy.|  
  
## <a name="administrator-console-events"></a>Eventos de la consola de administrador  
Los siguientes eventos de la consola de administrador generalmente indican errores de autenticación, los tokes no válidos o caducado las cookies.  
  
|Síntoma o evento|Causa posible|Resolución|  
|--------------------|------------------|--------------|  
|11005<br /><br />Proxy de aplicación Web no se pudo crear la clave de cifrado de cookies mediante el secreto de la configuración.|El parámetro "AccessCookiesEncryptionKey" de la configuración global se cambió por el comando de PowerShell: Set-WebApplicationProxyConfiguration -RegenerateAccessCookiesEncryptionKey|No se requiere ninguna acción. Se quitó la cookie problemática y se redirige al usuario a STS para la autenticación.|  
|12000<br /><br />Proxy de aplicación Web no se pudo comprobar los cambios de configuración para al menos 60 minutos|Proxy de aplicación Web no puede tener acceso a la configuración de Proxy de aplicación Web mediante el comando Get-WebApplicationProxyConfiguration o aplicación. Esto se debe normalmente a la falta de conectividad con AD FS o la necesidad de renovación de confianza con AD FS.|Compruebe la conectividad con AD FS. Puede hacerlo mediante el https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake vínculo que no hay relación de confianza establecida entre la instancia de AD FS y el Proxy de aplicación Web. Si estas soluciones no funcionan, ejecute el Cmdlet Install-WebApplicationProxy.|  
|12003<br /><br />Proxy de aplicación Web no se pudo analizar la cookie de acceso.|Esto puede indicar que el Proxy de aplicación Web y AD FS no está conectado o que no reciben la misma configuración.|Compruebe la conectividad con AD FS. Puede hacerlo mediante el https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake vínculo que no hay relación de confianza establecida entre la instancia de AD FS y el Proxy de aplicación Web. Si estas soluciones no funcionan, ejecute el Cmdlet Install-WebApplicationProxy.|  
|12004<br /><br />Proxy de aplicación Web recibió una solicitud con una cookie de acceso no válida.|Este evento puede indicar que el Proxy de aplicación Web y AD FS no está conectado o que no reciben la misma configuración.<br /><br />Si se ha ejecutado el parámetro "AccessCookiesEncryptionKey" fue chaged por el comando de PowerShell Set-WebApplicationProxyConfiguration - RegenerateAccessCookiesEncryptionKey, este evento es normal y no se requiere ningún paso de resolución.|Compruebe la conectividad con AD FS. Puede hacerlo mediante el https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake vínculo que no hay relación de confianza establecida entre la instancia de AD FS y el Proxy de aplicación Web. Si estas soluciones no funcionan, ejecute el Cmdlet Install-WebApplicationProxy.|  
|12008<br /><br />Proxy de aplicación Web supera el número máximo de intentos de autenticación de Kerberos permitidos en el servidor back-end.|Este evento puede indicar una configuración incorrecta entre el Proxy de aplicación Web y el servidor de aplicaciones de back-end o un problema en la configuración de fecha y hora en ambos equipos.|El servidor backend rechazó el vale Kerberos creado por el Proxy de aplicación Web. Compruebe que la configuración de Web Application Proxy y el servidor de aplicaciones de back-end están configurados correctamente.<br /><br />Asegúrese de que la configuración de fecha y hora en el Proxy de aplicación Web y el servidor de aplicaciones de back-end están sincronizados.|  
|12011<br /><br />Proxy de aplicación Web recibió una solicitud con una firma de la cookie de acceso no válida.|Este evento puede indicar que el Proxy de aplicación Web y AD FS no está conectado o que no reciben la misma configuración. Si se ha ejecutado el parámetro "AccessCookiesEncryptionKey" fue chaged por el comando de PowerShell Set-WebApplicationProxyConfiguration - RegenerateAccessCookiesEncryptionKey, este evento es normal y no se requiere ningún paso de resolución.|Compruebe la conectividad con AD FS. Puede hacerlo mediante el https://<FQDN_AD_FS_Proxy>/FederationMetadata/2007-06/FederationMetadata.xmlMake vínculo que no hay relación de confianza establecida entre la instancia de AD FS y el Proxy de aplicación Web. Si estas soluciones no funcionan, ejecute el Cmdlet Install-WebApplicationProxy.|  
|12027<br /><br />El proxy se ha encontrado un error inesperado al procesar la solicitud. El nombre proporcionado no es un nombre de cuenta formado correctamente.|Este evento puede indicar una configuración incorrecta entre el Proxy de aplicación Web y el servidor de controlador de dominio o un problema en la configuración de fecha y hora en ambos equipos.|El controlador de dominio rechazó el vale Kerberos creado por el Proxy de aplicación Web. Compruebe que la configuración de Web Application Proxy y el servidor de aplicaciones de back-end están configurados correctamente, especialmente la configuración de SPN. Asegúrese de que el Proxy de aplicación Web está unido al mismo dominio que el controlador de dominio para asegurarse de que el controlador de dominio establece la confianza con Web Application Proxy.Make asegurarse que la configuración de fecha y hora en el Proxy de aplicación Web y la controlador de dominio están sincronizadas.|  
|13012<br /><br />Proxy de aplicación Web recibe una firma del token perimetral no válida||Asegúrese de que ha actualizado el Proxy de aplicación Web con [2955164 KB](https://go.microsoft.com/fwlink/?LinkId=400701).|  
|13013<br /><br />Proxy de aplicación Web recibió una solicitud que contenía un token caducado edge.|Proxy de aplicación Web y AD FS no tienen relojes sincronizados.|Sincronizar los relojes entre el Proxy de aplicación Web y AD FS.|  
|13014<br /><br />Proxy de aplicación Web recibió una solicitud con un token de edge no válidos. El token no es válido porque no se puede analizar.|Esto puede indicar un problema con la configuración de AD FS.|Compruebe la configuración de AD FS y, si es necesario, restablecer la configuración predeterminada.|  
|13015<br /><br />Proxy de aplicación Web recibió una solicitud con una cookie de acceso caducado.|Esto podría indicar que los relojes de los que no están sincronizadas.|Si está trabajando con un clúster de máquinas de Proxy de aplicación Web, asegúrese de que se sincroniza la fecha y hora de las máquinas.|  
|13016<br /><br />Proxy de aplicación Web no se puede recuperar un vale de Kerberos en nombre del usuario porque no hay ningún UPN en el token perimetral o en la cookie de acceso.|Hay un problema con la configuración de STS.|Corregir la configuración de notificación UPN en STS.|  
|13019<br /><br />Proxy de aplicación Web no se puede recuperar un vale de Kerberos en nombre del usuario debido al siguiente error general de API|Este evento puede indicar una configuración incorrecta entre el Proxy de aplicación Web y el servidor de controlador de dominio o un problema en la configuración de fecha y hora en ambos equipos.|El controlador de dominio rechazó el vale Kerberos creado por el Proxy de aplicación Web. Compruebe que la configuración de Web Application Proxy y el servidor de aplicaciones de back-end están configurados correctamente, especialmente la configuración de SPN. Asegúrese de que el Proxy de aplicación Web está unido al mismo dominio que el controlador de dominio para asegurarse de que el controlador de dominio establece la confianza con Web Application Proxy.Make asegurarse que la configuración de fecha y hora en el Proxy de aplicación Web y la controlador de dominio están sincronizadas.|  
|13020<br /><br />Proxy de aplicación Web no puede recuperar un vale de Kerberos en nombre del usuario no está definido el SPN del servidor back-end.|Este evento puede indicar una configuración incorrecta entre el Proxy de aplicación Web y el servidor de controlador de dominio o un problema en la configuración de fecha y hora en ambos equipos.|El controlador de dominio rechazó el vale Kerberos creado por el Proxy de aplicación Web. Compruebe que la configuración de Web Application Proxy y el servidor de aplicaciones de back-end están configurados correctamente, especialmente la configuración de SPN. Asegúrese de que el Proxy de aplicación Web está unido al mismo dominio que el controlador de dominio para asegurarse de que el controlador de dominio establece la confianza con Web Application Proxy.Make asegurarse que la configuración de fecha y hora en el Proxy de aplicación Web y la controlador de dominio están sincronizadas.|  
|13022<br /><br />Proxy de aplicación Web no puede autenticar el usuario porque el servidor backend responde a los intentos de autenticación Kerberos con un error HTTP 401.|Este evento puede indicar una configuración incorrecta entre el Proxy de aplicación Web y el servidor de aplicaciones de back-end o un problema en la configuración de fecha y hora en ambos equipos.|El servidor backend rechazó el vale Kerberos creado por el Proxy de aplicación Web. Compruebe que la configuración de Web Application Proxy y el servidor de aplicaciones de back-end están configurados correctamente. Asegúrese de que la configuración de fecha y hora en el Proxy de aplicación Web y el servidor de aplicaciones de back-end están sincronizados.|  
|13025<br /><br />El cliente no presentar un certificado SSL para Proxy de aplicación Web.|Este evento puede indicar un problema en la configuración de fecha y hora.|Asegúrese de que la infraestructura de certificados es válida y que la fecha y hora de Web Application Proxy y AD FS están sincronizadas. Asegúrese de que la huella digital configurada para el Proxy de aplicación Web es la correcta.|  
|13026<br /><br />El cliente presenta un certificado SSL al Proxy de aplicación Web, pero el certificado no es válido: el certificado no coincide con la huella digital.|Este evento puede indicar un problema en la configuración de fecha y hora.|Asegúrese de que la infraestructura de certificados es válida y que la fecha y hora de Web Application Proxy y AD FS están sincronizadas. Asegúrese de que la huella digital configurada para el Proxy de aplicación Web es la correcta.|  
|13028<br /><br />Proxy de aplicación Web recibió una solicitud que contenía un token perimetral que no es válido.|Este evento puede indicar un problema en la configuración de fecha y hora.|Asegúrese de que la infraestructura de certificados es válida y que la fecha y hora de Web Application Proxy y AD FS están sincronizadas.|  
|13030<br /><br />El cliente presenta un certificado SSL al Proxy de aplicación Web, pero el proveedor de confianza no confía en la entidad de certificación que emitió el certificado de cliente.|Este evento puede indicar un problema en la configuración de fecha y hora.|Asegúrese de que la infraestructura de certificados es válida y que la fecha y hora de Web Application Proxy y AD FS están sincronizadas. Asegúrese de que la huella digital configurada para el Proxy de aplicación Web es la correcta.|  
|13031<br /><br />El cliente presenta un certificado SSL al Proxy de aplicación Web, pero la cadena de certificados termina en un certificado raíz que no es de confianza para el proveedor de confianza.|Este evento puede indicar un problema en la configuración de fecha y hora.|Asegúrese de que la infraestructura de certificados es válida y que la fecha y hora de Web Application Proxy y AD FS están sincronizadas. Asegúrese de que la huella digital configurada para el Proxy de aplicación Web es la correcta.|  
|13032<br /><br />El cliente presenta un certificado SSL al Proxy de aplicación Web, pero el certificado no era válido para el uso solicitado.|Este evento puede indicar un problema en la configuración de fecha y hora.|Asegúrese de que la infraestructura de certificados es válida y que la fecha y hora de Web Application Proxy y AD FS están sincronizadas. Asegúrese de que la huella digital configurada para el Proxy de aplicación Web es la correcta.|  
|13033<br /><br />El cliente presenta un certificado SSL al Proxy de aplicación Web, pero el certificado no estaba dentro de su período de validez al comprobarlo con el reloj del sistema actual o la marca de tiempo en el archivo firmado.|Este evento puede indicar un problema en la configuración de fecha y hora.|Asegúrese de que la infraestructura de certificados es válida y que la fecha y hora de Web Application Proxy y AD FS están sincronizadas. Asegúrese de que la huella digital configurada para el Proxy de aplicación Web es la correcta.|  
|13034<br /><br />El cliente presenta un certificado SSL al Proxy de aplicación Web, pero el certificado no era válido.|Este evento puede indicar un problema en la configuración de fecha y hora.|Asegúrese de que la infraestructura de certificados es válida y que la fecha y hora de Web Application Proxy y AD FS están sincronizadas. Asegúrese de que la huella digital configurada para el Proxy de aplicación Web es la correcta.|  
  
Los siguientes eventos de la consola de administrador son normalmente indicativos de problemas relacionados con la configuración de aprovisionamiento, la solicitud que no son correctas, los servidores back-end que no son accesibles y desbordamientos de búfer.  
  
|Síntoma o evento|Causa posible|Resolución|  
|--------------------|------------------|--------------|  
|12019<br /><br />Proxy de aplicación Web no se pudo crear un agente de escucha para la siguiente dirección URL.|Una posible causa del evento es que otro servicio está escuchando en la misma dirección URL.|El administrador debe asegurarse de que nadie escucha o que se enlaza a las mismas direcciones URL. Para comprobarlo, ejecute el comando: netsh http show urlacl. Si esta dirección URL se usa otro componente que se ejecuta en el equipo Proxy de aplicación Web, quitarlo o usar una dirección URL diferente para publicar las aplicaciones a través de Proxy de aplicación Web.|  
|12020<br /><br />Proxy de aplicación Web no se pudo crear una reserva para la siguiente dirección URL.|Una posible causa del evento es que otro servicio tiene una reserva en la misma dirección URL.|El administrador debe asegurarse de que nadie se enlaza a las mismas direcciones URL. Para comprobarlo, ejecute el comando: netsh http show urlacl. Si esta dirección URL se usa otro componente que se ejecuta en el equipo Proxy de aplicación Web, quitarlo o usar una dirección URL diferente para publicar las aplicaciones a través de Proxy de aplicación Web.|  
|12021<br /><br />Proxy de aplicación Web no pudo enlazar el certificado de servidor SSL. Se aplicaron todas las demás opciones de configuración.|No se puede crear y establecer un registro de configuración de datos del certificado SSL.|Asegúrese de que las huellas digitales de certificados que están configuradas para Proxyapplications de aplicación Web se instalan en todos los equipos de Proxy de aplicación Web con una clave privada en el almacén del equipo local.|  
|13001<br /><br />El certificado de servidor SSL presentado a Web Application Proxy por el servidor back-end no es válido; el certificado no es de confianza.|Se encontraron uno o varios errores en el certificado de capa de Sockets seguros (SSL) enviado por el servidor. Esto podría indicar que el servidor back-end proporcionado SSL que no era válido o que no hay ninguna relación de confianza entre el Proxy de aplicación Web y el servidor back-end.|Validar un certificado SSL del servidor back-end. Asegúrese de que la máquina de Proxy de aplicación Web está configurada con las CA debe confiar en el certificado de servidor back-end de raíz adecuado.|  
|13006|Cuando el código de error es 0x80072ee7, el failurrre se debe a la incapacidad de resolver la dirección URL del servidor back-end. Otros códigos de error se describen en [https://msdn.microsoft.com/library/windows/desktop/aa384110(v=vs.85)](https://msdn.microsoft.com/library/windows/desktop/aa384110(v=vs.85))|Compruebe que la dirección URL del servidor back-end es correcta y que se puedan resolver correctamente desde la máquina de Proxy de aplicación Web en su nombre.|  
|13007<br /><br />No se recibió la respuesta HTTP del servidor back-end dentro del intervalo esperado.|La solicitud al servidor back-end se agotó el tiempo o es lenta o no responde.|Compruebe la configuración del servidor back-end. Si es muy lenta, compruebe la conectividad con el servidor back-end y también considere la posibilidad de cambiar el cmdlet de parámetro de configuración global de Proxy de aplicación Web para InactiveTransactionsTimeoutSec.|  
  
## <a name="see-also"></a>Vea también  
[Novedades de Proxy de aplicación Web en Windows Server 2016](web-application-proxy-windows-server.md)  
[Trabajar con Web Application Proxy](assetId:///b607b717-2172-4271-98d1-fa8162e0bb2e)  
  


